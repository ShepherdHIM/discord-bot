const { SlashCommandBuilder, EmbedBuilder, ActionRowBuilder, ButtonBuilder, ButtonStyle } = require('discord.js');

module.exports = {
    data: new SlashCommandBuilder()
        .setName('yardim')
        .setDescription('Tum komutlari ve ozellikleri goruntule')
        .addStringOption(option =>
            option.setName('kategori')
                .setDescription('Belirli bir kategori secin')
                .setRequired(false)
                .addChoices(
                    { name: 'Muzik', value: 'muzik' },
                    { name: 'Oyunlar', value: 'oyunlar' },
                    { name: 'Profil & Istatistikler', value: 'profil' },
                    { name: 'Ses Aktivitesi', value: 'ses' },
                    { name: 'Sunucu Yonetimi', value: 'yonetim' },
                    { name: 'Genel', value: 'genel' }
                )),
    
    async execute(interaction) {
        console.log('Help command executed');
        
        try {
            // Respond immediately to avoid timeout
            if (!interaction.replied && !interaction.deferred) {
                const category = interaction.options?.getString('kategori');
                
                if (category) {
                    await this.showCategoryHelp(interaction, category);
                } else {
                    await this.showMainHelp(interaction);
                }
            }
        } catch (error) {
            console.error('Error in help command:', error);
        }
    },
    
    async showMainHelp(interaction) {
        console.log('Showing main help');
        
        const embed = new EmbedBuilder()
            .setColor('#0099ff')
            .setTitle('ü§ñ Bot Yardim - Tum Komutlar')
            .setDescription('Bu bot Turkce komutlarla calisir! Asagida tum ozellikler ve komutlar bulunmaktadir.')
            .setThumbnail(interaction.client.user.displayAvatarURL())
            .addFields(
                {
                    name: 'üéµ Muzik Komutlari',
                    value: '`/muzik` - Muzik calmak, duraklatmak ve kontrol etmek icin\n**14 alt komut mevcut**',
                    inline: true
                },
                {
                    name: 'üéÆ Oyun Komutlari', 
                    value: '`/oyunlar` - XP ve coin kazanmak icin eglenceli oyunlar\n**7 farkli oyun**',
                    inline: true
                },
                {
                    name: 'üë§ Profil & Istatistikler',
                    value: '`/profil` - Profilinizi goruntuleyin\n`/liderlik-tablosu` - Sunucu siralamalari',
                    inline: true
                },
                {
                    name: 'üé≠ Roller & Seviyeler',
                    value: '`/rol-yonetimi` - Seviye rollerini yonetin\nOtomatik rol atamasi',
                    inline: true
                },
                {
                    name: 'üé§ Ses Aktivitesi',
                    value: '`/ses-durumu` - Aktif ses kullanicilari\n`/ses-ayarlari` - Yonetici ayarlari',
                    inline: true
                },
                {
                    name: '‚öôÔ∏è Sunucu Yonetimi',
                    value: '`/kanal-ayarla` - Duyuru kanallari\n`/admin` - XP/Coin oran y√∂netimi\n`/sunucu-bilgi` - Sunucu bilgileri',
                    inline: true
                },
                {
                    name: 'üõ†Ô∏è Genel Komutlar',
                    value: '`/ping` - Bot gecikme testi\n`/bilgi-yarismasi` - Bilgi oyunu\n`/yardim` - Bu yardim menusu',
                    inline: true
                }
            )
            .addFields({
                name: 'üí∞ XP & Coin Sistemi',
                value: '‚Ä¢ Ses kanallarinda her dakika **XP** ve **coin** kazanin\n‚Ä¢ Muzik dinleyerek de odul kazanin\n‚Ä¢ Oyunlar oynayarak ekstra coin elde edin\n‚Ä¢ Her 100 XP = 1 seviye',
                inline: false
            })
            .setFooter({ 
                text: `${interaction.guild?.name || 'Sunucu'} ‚Ä¢ Detaylar icin kategori butonlarini kullanin`,
                iconURL: interaction.guild?.iconURL()
            })
            .setTimestamp();
        
        // Create category buttons
        const row1 = new ActionRowBuilder()
            .addComponents(
                new ButtonBuilder()
                    .setCustomId('help_muzik')
                    .setLabel('Muzik')
                    .setEmoji('üéµ')
                    .setStyle(ButtonStyle.Primary),
                new ButtonBuilder()
                    .setCustomId('help_oyunlar')
                    .setLabel('Oyunlar')
                    .setEmoji('üéÆ')
                    .setStyle(ButtonStyle.Primary),
                new ButtonBuilder()
                    .setCustomId('help_profil')
                    .setLabel('Profil')
                    .setEmoji('üë§')
                    .setStyle(ButtonStyle.Primary),
                new ButtonBuilder()
                    .setCustomId('help_ses')
                    .setLabel('Ses')
                    .setEmoji('üé§')
                    .setStyle(ButtonStyle.Primary),
                new ButtonBuilder()
                    .setCustomId('help_yonetim')
                    .setLabel('Yonetim')
                    .setEmoji('‚öôÔ∏è')
                    .setStyle(ButtonStyle.Primary)
            );
        
        const row2 = new ActionRowBuilder()
            .addComponents(
                new ButtonBuilder()
                    .setCustomId('help_genel')
                    .setLabel('Genel')
                    .setEmoji('üõ†Ô∏è')
                    .setStyle(ButtonStyle.Secondary),
                new ButtonBuilder()
                    .setCustomId('help_ozellikler')
                    .setLabel('Ozellikler')
                    .setEmoji('‚ú®')
                    .setStyle(ButtonStyle.Success),
                new ButtonBuilder()
                    .setCustomId('help_kurulum')
                    .setLabel('Ilk Kurulum')
                    .setEmoji('üöÄ')
                    .setStyle(ButtonStyle.Success)
            );
        
        // Respond immediately
        if (!interaction.replied && !interaction.deferred) {
            await interaction.reply({ embeds: [embed], components: [row1, row2], flags: 64 });
        }
    },
    
    async showCategoryHelp(interaction, category) {
        console.log(`Showing category help: ${category}`);
        let embed;
        
        switch (category) {
            case 'muzik':
                embed = this.createMusicHelp();
                break;
            case 'oyunlar':
                embed = this.createGamesHelp();
                break;
            case 'profil':
                embed = this.createProfileHelp();
                break;
            case 'ses':
                embed = this.createVoiceHelp();
                break;
            case 'yonetim':
                embed = this.createManagementHelp();
                break;
            case 'genel':
                embed = this.createGeneralHelp();
                break;
            case 'ozellikler':
                embed = this.createFeaturesHelp();
                break;
            case 'kurulum':
                embed = this.createSetupHelp();
                break;
            case 'back':
                return this.showMainHelp(interaction);
            default:
                return this.showMainHelp(interaction);
        }
        
        const backButton = new ActionRowBuilder()
            .addComponents(
                new ButtonBuilder()
                    .setCustomId('help_back')
                    .setLabel('Ana Menuye Don')
                    .setEmoji('‚óÄÔ∏è')
                    .setStyle(ButtonStyle.Secondary)
            );
        
        // Respond immediately
        if (!interaction.replied && !interaction.deferred) {
            await interaction.reply({ embeds: [embed], components: [backButton], flags: 64 });
        }
    },
    
    createMusicHelp() {
        return new EmbedBuilder()
            .setColor('#FF6B00')
            .setTitle('üéµ Muzik Komutlari')
            .setDescription('YouTube ve diger platformlardan muzik cal!')
            .addFields(
                {
                    name: '‚ñ∂Ô∏è Temel Kontroller',
                    value: '`/muzik cal [sarki]` - Sarki veya playlist cal\n`/muzik duraklat` - Duraklat/devam ettir\n`/muzik gecis` - Sonraki sarkiya gec\n`/muzik durdur` - Muzigi durdur',
                    inline: false
                },
                {
                    name: 'üìã Sira Yonetimi',
                    value: '`/muzik sira` - Calma sirasini goster\n`/muzik temizle` - Sirayi temizle\n`/muzik karistir` - Sirayi karistir\n`/muzik cikar [pozisyon]` - Sarkiyi kaldir',
                    inline: false
                },
                {
                    name: 'üîß Gelismis Ozellikler',
                    value: '`/muzik ses [seviye]` - Ses seviyesi (1-100)\n`/muzik dongu [mod]` - Tekrar modu\n`/muzik simdi-calan` - Suanki sarki bilgileri\n`/muzik istatistikler` - Muzik istatistikleri',
                    inline: false
                },
                {
                    name: 'üí∞ Oduller',
                    value: 'Muzik dinleyerek **dakikada 2 XP ve 1 coin** kazanin!',
                    inline: false
                }
            )
            .setFooter({ text: 'Ses kanalinda olmalisiniz!' });
    },
    
    createGamesHelp() {
        return new EmbedBuilder()
            .setColor('#FF1493')
            .setTitle('üéÆ Oyun Komutlari')
            .setDescription('Eglenceli oyunlarla XP ve coin kazanin!')
            .addFields(
                {
                    name: 'üéØ Sans Oyunlari',
                    value: '`/oyunlar yazi-tura` - Klasik yazi tura\n`/oyunlar slot` - Slot makinesi\n`/oyunlar zar` - Zar atma oyunu\n`/oyunlar rulet` - Rulet oyunu',
                    inline: false
                },
                {
                    name: 'üß† Strateji Oyunlari',
                    value: '`/oyunlar tas-kagit-makas` - Klasik oyun\n`/oyunlar tahmin` - Sayi tahmin oyunu\n`/bilgi-yarismasi` - Bilgi yarismasi',
                    inline: false
                },
                {
                    name: 'üí∞ Oduller & Bonuslar',
                    value: '`/oyunlar gunluk` - Gunluk bonus al\n`/oyunlar istatistikler` - Oyun istatistiklerin',
                    inline: false
                },
                {
                    name: 'üèÜ Ipuclari',
                    value: '‚Ä¢ Gunluk bonusu unutmayin!\n‚Ä¢ Yuksek seviyede daha fazla bonus\n‚Ä¢ Bahis miktarini akillica secin',
                    inline: false
                }
            );
    },
    
    createProfileHelp() {
        return new EmbedBuilder()
            .setColor('#FFD700')
            .setTitle('üë§ Profil & Istatistikler')
            .setDescription('Ilerlemenizi takip edin ve siralamalari gorun!')
            .addFields(
                {
                    name: 'üìä Profil Komutlari',
                    value: '`/profil` - Kendi profilinizi gorun\n`/profil [@kullanici]` - Baskasinin profilini gorun',
                    inline: false
                },
                {
                    name: 'üèÜ Liderlik Tablolari',
                    value: '`/liderlik-tablosu xp` - XP siralamalari\n`/liderlik-tablosu coins` - Coin siralamalari\n`/liderlik-tablosu voice_time` - Ses suresi siralamalari',
                    inline: false
                },
                {
                    name: 'üìà Seviye Sistemi',
                    value: '**100 XP = 1 Seviye**\n‚Ä¢ Yeni Baslayanlar (0-4)\n‚Ä¢ Yukselenler (5-9)\n‚Ä¢ Aktif Katilimcilar (10-19)\n‚Ä¢ Deneyimli Uye (20-29)\n‚Ä¢ Efsanevi Usta (100+)',
                    inline: false
                }
            );
    },
    
    createVoiceHelp() {
        return new EmbedBuilder()
            .setColor('#00FF00')
            .setTitle('üé§ Ses Aktivitesi')
            .setDescription('Ses kanallarinda vakit gecirerek XP ve coin kazanin!')
            .addFields(
                {
                    name: 'üìä Durum Komutlari',
                    value: '`/ses-durumu` - Kim ses kanalinda ve kim odul kazaniyor\n`/ses-ayarlari goster` - Mevcut ayarlar',
                    inline: false
                },
                {
                    name: '‚öôÔ∏è Yonetici Ayarlari',
                    value: '`/ses-ayarlari xp-orani` - Dakika basina XP\n`/ses-ayarlari coin-orani` - Dakika basina coin\n`/ses-ayarlari minimum-uyeler` - Minimum kisi sayisi',
                    inline: false
                },
                {
                    name: 'üí∞ Nasil Odul Kazanilir',
                    value: '‚Ä¢ Ses kanalinda olmak\n‚Ä¢ Susturulmamis olmak\n‚Ä¢ Sagirlastirilmamis olmak\n‚Ä¢ Minimum kisi sayisi saglanmali',
                    inline: false
                }
            );
    },
    
    createManagementHelp() {
        return new EmbedBuilder()
            .setColor('#8B00FF')
            .setTitle('‚öôÔ∏è Sunucu Yonetimi')
            .setDescription('Sunucu ayarlarini yapilandir (Yonetici yetkisi gerekir)')
            .addFields(
                {
                    name: 'üëë Admin Komutlarƒ±',
                    value: '`/admin xp-ver` - Kullanƒ±cƒ±ya XP ver\n`/admin coin-ver` - Kullanƒ±cƒ±ya coin ver\n`/admin xp-al` - Kullanƒ±cƒ±dan XP al\n`/admin coin-al` - Kullanƒ±cƒ±dan coin al\n`/admin sifirla` - T√ºm istatistikleri sƒ±fƒ±rla',
                    inline: false
                },
                {
                    name: '‚öôÔ∏è **XP & Coin Oran Y√∂netimi**',
                    value: '`/admin xp-orani [oran]` - **Dakika ba≈üƒ±na XP oranƒ± ayarla**\n`/admin coin-orani [oran]` - **Dakika ba≈üƒ±na coin oranƒ± ayarla**\n`/admin oranlar-goster` - Mevcut oranlarƒ± g√∂ster',
                    inline: false
                },
                {
                    name: 'üé≠ **Seviye Rol Y√∂netimi**',
                    value: '`/rol-yonetimi ekle [seviye] [rol]` - Seviye i√ßin rol ayarla\n`/rol-yonetimi kaldir [seviye]` - Seviye rol√ºn√º kaldƒ±r\n`/rol-yonetimi liste` - T√ºm seviye rollerini g√∂ster',
                    inline: false
                },
                {
                    name: 'üìä Oran Y√∂netimi',
                    value: '`/oran-yonetimi goster` - Detaylƒ± oran analizi\n`/oran-yonetimi hizli-ayar` - √ñn tanƒ±mlƒ± profiller\n`/oran-yonetimi ozel-ayar` - √ñzel oran ayarlama\n`/oran-yonetimi hesaplama` - Kazan√ß hesaplama\n`/oran-yonetimi karsilastir` - Profil kar≈üƒ±la≈ütƒ±rma',
                    inline: false
                },
                {
                    name: 'üì¢ Kanal Ayarlari',
                    value: '`/kanal-ayarla goster` - Mevcut ayarlar\n`/kanal-ayarla seviye-atlamasi` - Seviye duyuru kanali\n`/kanal-ayarla hosgeldin` - Hosgeldin kanali\n`/kanal-ayarla duyurular` - Bot duyuru kanali',
                    inline: false
                },
                {
                    name: 'üé§ Ses Aktivitesi',
                    value: '`/ses-ayarlari goster` - Mevcut ayarlar\n`/ses-ayarlari minimum-uyeler` - Minimum ki≈üi sayƒ±sƒ±\n`/ses-durumu` - Aktif ses durumu',
                    inline: false
                },
                {
                    name: 'üìã Bilgi Komutlari',
                    value: '`/sunucu-bilgi` - Sunucu detaylari\n`/kullanici-bilgi [@kullanici]` - Kullanici bilgileri',
                    inline: false
                },
                {
                    name: 'üõ†Ô∏è Yardimci Komutlar',
                    value: '`/soyle [mesaj]` - Bot ile mesaj gonder\n`/ping` - Bot performans testi',
                    inline: false
                }
            );
    },
    
    createGeneralHelp() {
        return new EmbedBuilder()
            .setColor('#00BFFF')
            .setTitle('üõ†Ô∏è Genel Komutlar')
            .setDescription('Temel bot fonksiyonlari')
            .addFields(
                {
                    name: 'üèì Test Komutlari',
                    value: '`/ping` - Bot yanit suresi ve gecikme\n`/yardim` - Bu yardim menusu',
                    inline: false
                },
                {
                    name: 'üß† Egitim & Eglence',
                    value: '`/bilgi-yarismasi` - Bilgi sorulari\n`/soyle [mesaj]` - Bot ile mesaj',
                    inline: false
                },
                {
                    name: 'üìä Bilgi Komutlari',
                    value: '`/kullanici-bilgi` - Kullanici profili\n`/sunucu-bilgi` - Sunucu istatistikleri',
                    inline: false
                }
            );
    },
    
    createFeaturesHelp() {
        return new EmbedBuilder()
            .setColor('#32CD32')
            .setTitle('‚ú® Bot √ñzellikleri')
            .setDescription('Bu botun sunduƒüu t√ºm harika √∂zellikler!')
            .addFields(
                {
                    name: 'üé§ Ses Aktivitesi Takibi',
                    value: '‚Ä¢ Dakika bazƒ±nda XP ve coin kazanma\n‚Ä¢ M√ºzik dinleyerek bonus √∂d√ºller\n‚Ä¢ Otomatik ses durumu g√ºncelleme\n‚Ä¢ Minimum kullanƒ±cƒ± sayƒ±sƒ± kontrol√º',
                    inline: false
                },
                {
                    name: 'üéÆ Kapsamlƒ± Oyun Sistemi',
                    value: '‚Ä¢ 7 farklƒ± oyun t√ºr√º\n‚Ä¢ ≈ûans ve strateji oyunlarƒ±\n‚Ä¢ G√ºnl√ºk bonus sistemi\n‚Ä¢ Detaylƒ± oyun istatistikleri',
                    inline: false
                },
                {
                    name: 'üéµ M√ºzik Entegrasyonu',
                    value: '‚Ä¢ YouTube ve diƒüer platformlar\n‚Ä¢ 14 farklƒ± m√ºzik komutu\n‚Ä¢ √áalma listesi y√∂netimi\n‚Ä¢ M√ºzik dinleyerek √∂d√ºl kazanma',
                    inline: false
                },
                {
                    name: 'üìà Geli≈ümi≈ü Profil Sistemi',
                    value: '‚Ä¢ Seviye tabanlƒ± unvanlar\n‚Ä¢ ƒ∞nteraktif profil butonlarƒ±\n‚Ä¢ Detaylƒ± istatistikler\n‚Ä¢ Liderlik tablolarƒ±',
                    inline: false
                },
                {
                    name: '‚öôÔ∏è Y√∂netici Ara√ßlarƒ±',
                    value: '‚Ä¢ XP/Coin oran y√∂netimi\n‚Ä¢ Kanal yapƒ±landƒ±rmasƒ±\n‚Ä¢ Kullanƒ±cƒ± istatistik y√∂netimi\n‚Ä¢ Sunucu analizleri',
                    inline: false
                }
            );
    },
    
    createSetupHelp() {
        return new EmbedBuilder()
            .setColor('#FF4500')
            .setTitle('üöÄ ƒ∞lk Kurulum Rehberi')
            .setDescription('Botu sunucunuzda optimize etmek i√ßin adƒ±mlar')
            .addFields(
                {
                    name: '1Ô∏è‚É£ Bot ƒ∞zinleri',
                    value: '‚Ä¢ `Manage Messages` - Mesaj y√∂netimi\n‚Ä¢ `Connect` & `Speak` - Ses kanalƒ± eri≈üimi\n‚Ä¢ `Embed Links` - Zengin i√ßerik g√∂nderme\n‚Ä¢ `Use Slash Commands` - Slash komut kullanƒ±mƒ±',
                    inline: false
                },
                {
                    name: '2Ô∏è‚É£ Kanal Yapƒ±landƒ±rmasƒ±',
                    value: '`/kanal-ayarla` komutunu kullanarak:\n‚Ä¢ Seviye duyuru kanalƒ± ayarlayƒ±n\n‚Ä¢ Ho≈ügeldin mesajƒ± kanalƒ± se√ßin\n‚Ä¢ Bot duyuru kanalƒ± belirleyin',
                    inline: false
                },
                {
                    name: '3Ô∏è‚É£ Ses Ayarlarƒ±',
                    value: '`/ses-ayarlari` ile:\n‚Ä¢ Minimum kullanƒ±cƒ± sayƒ±sƒ±nƒ± ayarlayƒ±n\n‚Ä¢ XP ve coin oranlarƒ±nƒ± optimize edin\n‚Ä¢ Ses aktivitesi gereksinimlerini belirleyin',
                    inline: false
                },
                {
                    name: '4Ô∏è‚É£ Admin Ara√ßlarƒ±',
                    value: '`/admin` ve `/oran-yonetimi` komutlarƒ±yla:\n‚Ä¢ Sunucu i√ßin optimal oranlarƒ± ayarlayƒ±n\n‚Ä¢ ƒ∞lk kullanƒ±cƒ±lara ho≈ügeldin bonusu verin\n‚Ä¢ Sistem performansƒ±nƒ± izleyin',
                    inline: false
                },
                {
                    name: '‚úÖ ƒ∞lk Test',
                    value: '‚Ä¢ `/ping` ile bot performansƒ±nƒ± test edin\n‚Ä¢ `/profil` ile kullanƒ±cƒ± sistemini deneyin\n‚Ä¢ Bir ses kanalƒ±na girerek √∂d√ºl sistemini test edin\n‚Ä¢ `/oyunlar` ile oyun sistemini deneyin',
                    inline: false
                }
            )
            .setFooter({ text: 'Sorularƒ±nƒ±z i√ßin yardƒ±m kanalƒ±nƒ± kullanƒ±n!' });
    }
};